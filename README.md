# AI æ—…è¡Œè§„åˆ’å¸ˆ (AI Travel Planner)

ä¸€ä¸ªåŸºäº AI æŠ€æœ¯çš„æ™ºèƒ½æ—…è¡Œè§„åˆ’ Web åº”ç”¨ï¼Œæ”¯æŒå¤šæ¨¡å‹é€‰æ‹©ã€è¯­éŸ³è¾“å…¥ã€æ™ºèƒ½è¡Œç¨‹ç”Ÿæˆã€è´¹ç”¨ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### å·²å®ç°åŠŸèƒ½

- **ğŸ¤ è¯­éŸ³è¾“å…¥** - åŸºäº Web Speech API çš„è¯­éŸ³è¯†åˆ«ï¼Œæ”¯æŒä¸­æ–‡è¯­éŸ³è¾“å…¥
- **ğŸ¤– å¤š AI æ¨¡å‹æ”¯æŒ** - æ”¯æŒ DeepSeek Chatã€DeepSeek Reasonerã€Qwen2.5 72B (ModelScope)
- **ğŸ§  LangGraph å¤šæ™ºèƒ½ä½“æ¶æ„** - 7 ä¸ªä¸“å®¶ Agent åä½œï¼Œæ™ºèƒ½è¡Œç¨‹è§„åˆ’ï¼ˆ[æŸ¥çœ‹æ–‡æ¡£](docs/å¤šæ™ºèƒ½ä½“æ¶æ„å‡çº§è®¡åˆ’.md)ï¼‰
- **ğŸ“‹ æ™ºèƒ½è¡Œç¨‹è§„åˆ’** - AI ç”Ÿæˆè¯¦ç»†æ—…è¡Œè®¡åˆ’ï¼ŒåŒ…å«æ¯æ—¥è¡Œç¨‹ã€æ™¯ç‚¹æ¨èã€é¤å…æ¨è
- **ğŸ’° è´¹ç”¨é¢„ä¼°** - æ™ºèƒ½é¢„ç®—åˆ†æå’Œè´¹ç”¨ä¼°ç®—
- **ğŸ” ç”¨æˆ·è®¤è¯** - Supabase è®¤è¯é›†æˆï¼Œæ”¯æŒé‚®ç®±/å¯†ç æ³¨å†Œç™»å½•
- **ğŸ“Š è¡Œç¨‹ç®¡ç†** - åˆ›å»ºã€ä¿å­˜å’ŒæŸ¥çœ‹å¤šä¸ªæ—…è¡Œè®¡åˆ’
- **ğŸ—ºï¸ åœ°å›¾é›†æˆ** - é«˜å¾·åœ°å›¾æ˜¾ç¤ºæ™¯ç‚¹ä½ç½®ã€è·¯çº¿è§„åˆ’ï¼ˆ[æŸ¥çœ‹æ–‡æ¡£](docs/MAP_INTEGRATION.md)ï¼‰
- **ğŸ’µ è´¹ç”¨è¿½è¸ª** - è¯­éŸ³å½•å…¥å¼€é”€ã€å®æ—¶é¢„ç®—å¯¹æ¯”ã€è´¹ç”¨åˆ†ç±»ç®¡ç†
- **ğŸ“ˆ æ•°æ®å¯è§†åŒ–** - é¢„ç®—ä½¿ç”¨å›¾è¡¨ã€è´¹ç”¨åˆ†å¸ƒåˆ†æã€æ¯æ—¥å¼€é”€è¶‹åŠ¿ï¼ˆ[æŸ¥çœ‹æ–‡æ¡£](docs/BUDGET_VISUALIZATION.md)ï¼‰
- **ğŸ”— è¡Œç¨‹åˆ†äº«** - ç”Ÿæˆåˆ†äº«é“¾æ¥ã€äºŒç»´ç ã€æ”¯æŒç¤¾äº¤åª’ä½“åˆ†äº«ï¼ˆ[æŸ¥çœ‹æ–‡æ¡£](docs/SHARE_FEATURE.md)ï¼‰
- **ğŸ“± PWA æ”¯æŒ** - å®‰è£…åˆ°ä¸»å±å¹•ï¼ŒåƒåŸç”Ÿåº”ç”¨ä¸€æ ·ä½¿ç”¨
- **ğŸ’¾ ç¦»çº¿ç¼“å­˜** - æŸ¥çœ‹å’Œç¼–è¾‘å·²ç¼“å­˜çš„è¡Œç¨‹ï¼Œæ”¯æŒç¦»çº¿è®¿é—®ï¼ˆ[æŸ¥çœ‹æ–‡æ¡£](docs/OFFLINE_USAGE.md)ï¼‰
- **âš™ï¸ ç”¨æˆ·è®¾ç½®** - è´¦æˆ·ç®¡ç†ã€å¯†ç ä¿®æ”¹ã€ä¸»é¢˜åˆ‡æ¢ã€API Keys ç®¡ç†ï¼ˆ[æŸ¥çœ‹æ–‡æ¡£](docs/SETTINGS_GUIDE.md)ï¼‰
- **ğŸ“„ PDF å¯¼å‡º** - å¯¼å‡ºè¡Œç¨‹ä¸º PDF æ–‡æ¡£ï¼Œæ”¯æŒæ‰“å°ä¼˜åŒ–ç‰ˆæœ¬ï¼Œå®Œç¾æ”¯æŒä¸­æ–‡
- **ğŸ”§ è¿›ç¨‹ç®¡ç†** - è‡ªåŠ¨æ£€æµ‹å’Œæ¸…ç†åƒµå°¸è¿›ç¨‹ï¼Œæ”¯æŒ PM2 ç”Ÿäº§çº§ç®¡ç†ï¼ˆ[æŸ¥çœ‹æ–‡æ¡£](docs/PROCESS_MANAGEMENT.md)ï¼‰

### è®¡åˆ’åŠŸèƒ½

- ç™¾åº¦åœ°å›¾æ”¯æŒ
- å¤šå¸ç§æ”¯æŒ
- è´¹ç”¨é¢„æµ‹åˆ†æ
- åˆ†äº«è®¿é—®ç»Ÿè®¡
- ç¦»çº¿åˆ›å»ºæ–°è¡Œç¨‹
- æ¨é€é€šçŸ¥

## ğŸš€ å¿«é€Ÿå¼€å§‹

> ğŸ’¡ **æ¨èå¯åŠ¨æ–¹å¼**: ä½¿ç”¨ `npm run dev:safe` å®‰å…¨å¯åŠ¨ï¼Œè‡ªåŠ¨é¿å…åƒµå°¸è¿›ç¨‹é—®é¢˜ã€‚è¯¦è§ [å¿«é€Ÿå¯åŠ¨æŒ‡å—](docs/QUICK_START.md)ã€‚

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env.local`ï¼š

```bash
cp .env.example .env.local
```

ç„¶åå¡«å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š

```env
# Supabaseï¼ˆå¿…éœ€ï¼‰
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key  # åˆ†äº«åŠŸèƒ½å¿…éœ€

# DeepSeek APIï¼ˆå¿…éœ€ - AI è¡Œç¨‹ç”Ÿæˆï¼‰
DEEPSEEK_API_KEY=your_deepseek_api_key
DEEPSEEK_BASE_URL=https://api.deepseek.com

# ModelScope APIï¼ˆå¯é€‰ - Qwen æ¨¡å‹ï¼‰
MODELSCOPE_API_KEY=your_modelscope_api_key
MODELSCOPE_BASE_URL=https://api-inference.modelscope.cn/v1/

# é«˜å¾·åœ°å›¾ APIï¼ˆå¿…éœ€ - ç”¨äºè¡Œç¨‹åœ°å›¾æ˜¾ç¤ºï¼‰
NEXT_PUBLIC_MAP_API_KEY=your_amap_api_key
AMAP_WEB_SERVICE_KEY=your_amap_web_service_key  # WebæœåŠ¡API Keyï¼ˆåç«¯ä½¿ç”¨ï¼‰

# æ•°æ®åŠ å¯†å¯†é’¥ï¼ˆå¿…éœ€ - ç”¨äº API Key åŠ å¯†å­˜å‚¨ï¼‰
ENCRYPTION_KEY=your_32_char_or_longer_encryption_key_here

# åº”ç”¨é…ç½®
NEXT_PUBLIC_BASE_URL=http://localhost:3008  # å¼€å‘ç¯å¢ƒï¼›ç”Ÿäº§ç¯å¢ƒæ”¹ä¸ºå®é™…åŸŸå

# LangGraph å¤šæ™ºèƒ½ä½“é…ç½®ï¼ˆå¯é€‰ï¼‰
NEXT_PUBLIC_USE_LANGGRAPH=true              # å¯ç”¨ LangGraph æ¶æ„
LANGGRAPH_TRACER=console                    # è¿½è¸ªåç«¯ï¼šconsole | json | langsmith
LANGGRAPH_METRICS_ENABLED=true              # å¯ç”¨æŒ‡æ ‡æ”¶é›†

# å…¶ä»–å¯é€‰æœåŠ¡
VOICE_API_KEY=your_voice_api_key
```

#### è·å– API Key

**Supabase:**
1. è®¿é—® [supabase.com](https://supabase.com) åˆ›å»ºé¡¹ç›®
2. è¿›å…¥ Settings â†’ API
3. å¤åˆ¶ä»¥ä¸‹å¯†é’¥ï¼š
   - `Project URL` â†’ `NEXT_PUBLIC_SUPABASE_URL`
   - `anon public` â†’ `NEXT_PUBLIC_SUPABASE_ANON_KEY`
   - `service_role` â†’ `SUPABASE_SERVICE_ROLE_KEY` âš ï¸ ä¿å¯†ï¼ä»…æœåŠ¡ç«¯ä½¿ç”¨

**DeepSeek (å¿…éœ€):**
1. è®¿é—® [platform.deepseek.com](https://platform.deepseek.com)
2. åˆ›å»º API Key
3. DeepSeek æä¾›ä¼˜ç§€çš„ä¸­æ–‡æ”¯æŒå’Œé«˜æ€§ä»·æ¯”

**ModelScope (å¯é€‰):**
1. è®¿é—® [modelscope.cn](https://modelscope.cn)
2. è¿›å…¥ä½“éªŒå¹³å° â†’ API æ¨ç†æœåŠ¡
3. åˆ›å»ºå¹¶è·å– API Keyï¼ˆæ”¯æŒ Qwen ç³»åˆ—æ¨¡å‹ï¼‰

**é«˜å¾·åœ°å›¾ (å¿…éœ€):**
1. è®¿é—® [lbs.amap.com](https://lbs.amap.com)
2. åˆ›å»ºåº”ç”¨å¹¶è·å– Web ç«¯ï¼ˆJS APIï¼‰Key å’Œ Web æœåŠ¡ API Key
3. è¯¦ç»†è¯´æ˜æŸ¥çœ‹ [docs/MAP_INTEGRATION.md](docs/MAP_INTEGRATION.md)

**åŠ å¯†å¯†é’¥ (å¿…éœ€):**
ä½¿ç”¨ Node.js ç”Ÿæˆå®‰å…¨çš„éšæœºå¯†é’¥ï¼š
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```
âš ï¸ å¯†é’¥è‡³å°‘ 32 ä¸ªå­—ç¬¦ï¼Œä¸è¦å°†å¯†é’¥æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

### 3. è®¾ç½®æ•°æ®åº“

åœ¨ Supabase SQL Editor ä¸­è¿è¡Œç»Ÿä¸€çš„æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼š

```bash
# å¤åˆ¶ database/init.sql çš„å…¨éƒ¨å†…å®¹åˆ° Supabase SQL Editor å¹¶æ‰§è¡Œ
# ä¸€æ¬¡æ€§å®Œæˆæ‰€æœ‰æ•°æ®åº“è®¾ç½®ï¼ŒåŒ…å«ï¼š
# - 4 ä¸ªæ ¸å¿ƒè¡¨ï¼šprofilesã€tripsã€expensesã€api_keys
# - å®Œæ•´çš„ RLS å®‰å…¨ç­–ç•¥
# - æ€§èƒ½ä¼˜åŒ–ç´¢å¼•
# - è‡ªåŠ¨æ›´æ–°è§¦å‘å™¨
# - ç”¨æˆ·è®¾ç½®åŠŸèƒ½ï¼ˆä¸»é¢˜ã€é»˜è®¤åå¥½ã€API Keys åŠ å¯†å­˜å‚¨ï¼‰
```

**å·²æœ‰é¡¹ç›®ï¼Ÿ** æ— éœ€æ‹…å¿ƒï¼è„šæœ¬åŒ…å«å‘åå…¼å®¹é€»è¾‘ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æ·»åŠ ç¼ºå¤±å­—æ®µï¼Œå®‰å…¨å‡çº§æ•°æ®åº“åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚

### 4. å¯åŠ¨é¡¹ç›®

**æ¨èæ–¹å¼ï¼ˆè‡ªåŠ¨å¤„ç†åƒµå°¸è¿›ç¨‹ï¼‰ï¼š**
```bash
npm run dev:safe
```

**æ ‡å‡†æ–¹å¼ï¼š**
```bash
npm run dev
```

**ç”Ÿäº§çº§ç®¡ç†ï¼ˆéœ€è¦ PM2ï¼‰ï¼š**
```bash
npm install -g pm2
npm run dev:pm2
```

è®¿é—® http://localhost:3008

**è¿è¡Œæµ‹è¯•ï¼š**
```bash
npm test                  # è¿è¡Œå•å…ƒæµ‹è¯•
npm run test:coverage     # æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
npm run test:e2e          # Playwright E2E æµ‹è¯•
```

**æ³¨æ„**ï¼š
- é»˜è®¤ç«¯å£ä¸º 3008ï¼Œå¯åœ¨ `package.json` ä¸­ä¿®æ”¹
- æ›´å¤šå¯åŠ¨é€‰é¡¹å’Œè¿›ç¨‹ç®¡ç†ï¼Œè¯·æŸ¥çœ‹ [è¿›ç¨‹ç®¡ç†æŒ‡å—](docs/PROCESS_MANAGEMENT.md)

## ğŸ“– ä½¿ç”¨æŒ‡å—

### åˆ›å»ºè¡Œç¨‹

1. **æ³¨å†Œ/ç™»å½•** - é¦–æ¬¡ä½¿ç”¨éœ€è¦æ³¨å†Œè´¦å·
2. **åˆ›å»ºæ–°è¡Œç¨‹** - ç‚¹å‡»"åˆ›å»ºæ–°è¡Œç¨‹"æŒ‰é’®
3. **å¡«å†™ä¿¡æ¯**ï¼š
   - **å‡ºå‘åœ°**ï¼ˆæ”¯æŒè¯­éŸ³è¾“å…¥ï¼‰- ç”¨äºå‡†ç¡®ä¼°ç®—äº¤é€šè´¹ç”¨
   - **ç›®çš„åœ°**ï¼ˆæ”¯æŒè¯­éŸ³è¾“å…¥ï¼‰
   - å‡ºå‘å’Œè¿”å›æ—¥æœŸ
   - é¢„ç®—é‡‘é¢
   - å‡ºè¡Œäººæ•°
   - æ—…è¡Œåå¥½
   - é€‰æ‹© AI æ¨¡å‹
4. **ç”Ÿæˆè¡Œç¨‹** - ç‚¹å‡»"ç”Ÿæˆæ—…è¡Œè®¡åˆ’"ï¼ŒAI å°†åœ¨å‡ ç§’å†…ç”Ÿæˆè¯¦ç»†è¡Œç¨‹
5. **æŸ¥çœ‹è¯¦æƒ…** - è‡ªåŠ¨è·³è½¬åˆ°è¡Œç¨‹è¯¦æƒ…é¡µï¼ŒæŸ¥çœ‹å®Œæ•´è®¡åˆ’å’Œåœ°å›¾

### ç”¨æˆ·è®¾ç½®

1. **è¿›å…¥è®¾ç½®** - ç‚¹å‡» Dashboard å³ä¸Šè§’çš„ã€Œè®¾ç½®ã€æŒ‰é’®
2. **è´¦æˆ·ä¿¡æ¯** - ä¿®æ”¹ç”¨æˆ·åã€å¤´åƒ
3. **å®‰å…¨è®¾ç½®** - ä¿®æ”¹å¯†ç ï¼ˆå¸¦å¼ºåº¦éªŒè¯ï¼‰
4. **åå¥½è®¾ç½®**ï¼š
   - é€‰æ‹©ä¸»é¢˜ï¼ˆæµ…è‰²/æ·±è‰²/è·Ÿéšç³»ç»Ÿï¼‰
   - è®¾ç½®é»˜è®¤ AI æ¨¡å‹
   - è®¾ç½®é»˜è®¤é¢„ç®—å’Œå‡ºå‘åœ°
5. **API Keys ç®¡ç†**ï¼š
   - æ·»åŠ æ‚¨è‡ªå·±çš„ DeepSeek/ModelScope/é«˜å¾·åœ°å›¾ API Keys
   - ç³»ç»Ÿå°†ä¼˜å…ˆä½¿ç”¨æ‚¨çš„ Keysï¼ˆAES-256 åŠ å¯†å­˜å‚¨ï¼‰
   - æµ‹è¯• Key æœ‰æ•ˆæ€§ï¼Œç®¡ç†å¤šä¸ªå¤‡ç”¨ Keys

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ [docs/SETTINGS_GUIDE.md](docs/SETTINGS_GUIDE.md)

### åˆ†äº«è¡Œç¨‹

1. **æ‰“å¼€è¡Œç¨‹è¯¦æƒ…** - è¿›å…¥æƒ³è¦åˆ†äº«çš„è¡Œç¨‹é¡µé¢
2. **ç‚¹å‡»åˆ†äº«æŒ‰é’®** - ç‚¹å‡»é¡¶éƒ¨çš„"åˆ†äº«è¡Œç¨‹"æŒ‰é’®
3. **å¼€å¯å…¬å¼€åˆ†äº«** - æ‰“å¼€"å…¬å¼€åˆ†äº«"å¼€å…³
4. **è·å–åˆ†äº«é“¾æ¥** - ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€çš„åˆ†äº«é“¾æ¥
5. **åˆ†äº«ç»™ä»–äºº**ï¼š
   - å¤åˆ¶é“¾æ¥ç›´æ¥åˆ†äº«
   - æ˜¾ç¤ºäºŒç»´ç ä¾›æ‰«æ
   - åˆ†äº«åˆ°ç¤¾äº¤åª’ä½“ï¼ˆå¾®ä¿¡ã€å¾®åšã€Twitterï¼‰
6. **ç®¡ç†åˆ†äº«** - éšæ—¶å¯ä»¥å…³é—­å…¬å¼€åˆ†äº«æˆ–é‡æ–°å¼€å¯

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ [docs/SHARE_FEATURE.md](docs/SHARE_FEATURE.md)

### AI æ¨¡å‹é€‰æ‹©

æœ¬é¡¹ç›®æ”¯æŒå¤šä¸ª AI æ¨¡å‹ï¼Œå¯æ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š

- **DeepSeek Chat** - ä¸­æ–‡æ”¯æŒä¼˜ç§€ï¼Œæ€§ä»·æ¯”é«˜ï¼Œæ¨èæ—¥å¸¸ä½¿ç”¨
- **DeepSeek Reasoner** - æ·±åº¦æ¨ç†æ¨¡å‹ï¼Œé€‚åˆå¤æ‚è¡Œç¨‹è§„åˆ’
- **Qwen2.5 72B (ModelScope)** - é˜¿é‡Œå·´å·´å¼€æºå¤§æ¨¡å‹ï¼Œä¸­æ–‡èƒ½åŠ›å¼º

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ [docs/MODEL_SELECTION.md](docs/MODEL_SELECTION.md)

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Next.js 15 (App Router)
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: Tailwind CSS
- **å›¾æ ‡**: Lucide React
- **çŠ¶æ€ç®¡ç†**: Zustand
- **PWA**: next-pwa + Workbox
- **ç¦»çº¿å­˜å‚¨**: IndexedDB (idb)
- **PDF ç”Ÿæˆ**: jsPDF + jspdf-autotable + html2canvas
- **å›¾è¡¨**: Recharts

### åç«¯
- **è®¤è¯ä¸æ•°æ®åº“**: Supabase (PostgreSQL + RLS)
- **API**: Next.js API Routes

### AI é›†æˆ
- **å¤§è¯­è¨€æ¨¡å‹**: DeepSeek + ModelScope (Qwen)
- **å¤šæ™ºèƒ½ä½“ç¼–æ’**: LangGraph (çŠ¶æ€å›¾ç¼–æ’ + æ¡ä»¶åˆ†æ”¯ + å¾ªç¯é‡è¯•)
- **è¯­éŸ³è¯†åˆ«**: Web Speech API
- **å›¾ç‰‡æœåŠ¡**: é«˜å¾·åœ°å›¾ POI ç…§ç‰‡
- **MCP åè®®**: Model Context Protocol å·¥å…·è°ƒç”¨

### æµ‹è¯•
- **å•å…ƒæµ‹è¯•**: Vitest + Testing Library
- **E2E æµ‹è¯•**: Playwright
- **æµ‹è¯•è¦†ç›–ç‡**: 80%+ é˜ˆå€¼
- **Mock**: MSW (Mock Service Worker)

### å¼€å‘å·¥å…·
- **è¿›ç¨‹ç®¡ç†**: PM2ï¼ˆç”Ÿäº§çº§è¿›ç¨‹ç®¡ç†ï¼‰
- **å¥åº·ç›‘æ§**: è‡ªå®šä¹‰å¥åº·æ£€æŸ¥è„šæœ¬
- **åŠ å¯†**: crypto-jsï¼ˆAES-256 åŠ å¯†ï¼‰
- **æ—¥æœŸå¤„ç†**: date-fns
- **æ•°æ®éªŒè¯**: Zod
- **CI/CD**: GitHub Actions

## ğŸ§  LangGraph å¤šæ™ºèƒ½ä½“æ¶æ„

é¡¹ç›®é‡‡ç”¨ LangGraph çŠ¶æ€å›¾ç¼–æ’å¤šä¸ªä¸“å®¶ Agent åä½œå®Œæˆè¡Œç¨‹è§„åˆ’ï¼Œé€šè¿‡ Feature Flag æ§åˆ¶å¯ç”¨ï¼š

```bash
# åœ¨ .env.local ä¸­å¯ç”¨
NEXT_PUBLIC_USE_LANGGRAPH=true
```

### æ¶æ„æ¦‚è§ˆ

```
ç”¨æˆ·è¾“å…¥
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Weather Scout    â”‚  è·å–å¤©æ°” + ç”Ÿæˆç­–ç•¥æ ‡ç­¾
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Itinerary Planner â”‚  ç”Ÿæˆè¡Œç¨‹éª¨æ¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Attraction Enricherâ”‚  å¢å¼ºæ™¯ç‚¹è¯¦æƒ…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Hotel   â”‚    â”‚Transport â”‚    â”‚  Dining  â”‚    å¹¶è¡Œæ‰§è¡Œ
â”‚  Agent   â”‚    â”‚  Agent   â”‚    â”‚  Agent   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Budget Critic    â”‚  é¢„ç®—å®¡è®¡ï¼ˆè¶…æ”¯è‡ªåŠ¨é‡è¯•ï¼‰
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Finalize Agent   â”‚  ç”Ÿæˆæœ€ç»ˆè¡Œç¨‹
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸“å®¶ Agent

| Agent | èŒè´£ | MCP å·¥å…· |
|-------|------|----------|
| Weather Scout | è·å–å¤©æ°”é¢„æŠ¥ï¼Œè¾“å‡ºç­–ç•¥æ ‡ç­¾ | `getWeatherForecast` |
| Itinerary Planner | ç”Ÿæˆè¡Œç¨‹éª¨æ¶ï¼ˆæ™¯ç‚¹é¡ºåºï¼‰ | `searchPOI`, `geocode` |
| Attraction Enricher | å¢å¼ºæ™¯ç‚¹è¯¦æƒ…ï¼ˆé—¨ç¥¨ã€å¼€æ”¾æ—¶é—´ç­‰ï¼‰ | `searchPOI` |
| Accommodation | æ¨èé…’åº—ä½å®¿ | `searchNearby` |
| Transport | è®¡ç®—äº¤é€šè·¯çº¿å’Œè´¹ç”¨ | `getDrivingRoute`, `getTransitRoute` |
| Dining | æ¨èé¤å… | `searchPOI` |
| Budget Critic | é¢„ç®—å®¡è®¡ï¼Œè¶…æ”¯è§¦å‘é‡è¯• | æ— ï¼ˆçº¯è®¡ç®—ï¼‰ |
| Finalize | æ•´åˆæ•°æ®ï¼Œè¾“å‡ºæœ€ç»ˆè¡Œç¨‹ | æ—  |

### å¯è§‚æµ‹æ€§

- **è¿½è¸ª**: æ”¯æŒ Consoleã€JSONã€LangSmith ä¸‰ç§è¿½è¸ªåç«¯
- **æŒ‡æ ‡**: Prometheus æ ¼å¼æŒ‡æ ‡ç«¯ç‚¹ (`/api/metrics`)
- **è°ƒè¯•é¡µé¢**: å¼€å‘ç¯å¢ƒå¯è®¿é—® `/dashboard/debug` æŸ¥çœ‹å·¥ä½œæµæ‰§è¡ŒçŠ¶æ€

è¯¦ç»†æ¶æ„è®¾è®¡è¯·æŸ¥çœ‹ [docs/å¤šæ™ºèƒ½ä½“æ¶æ„å‡çº§è®¡åˆ’.md](docs/å¤šæ™ºèƒ½ä½“æ¶æ„å‡çº§è®¡åˆ’.md)

## ğŸ“ é¡¹ç›®ç»“æ„

```
ai-travel-planner/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ api/                      # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ _middleware/          # API ä¸­é—´ä»¶ï¼ˆè®¤è¯ã€é”™è¯¯å¤„ç†ï¼‰
â”‚   â”‚   â”œâ”€â”€ _utils/               # API å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ generate-itinerary/   # è¡Œç¨‹ç”Ÿæˆ API (v1 å•ä½“æ¶æ„)
â”‚   â”‚   â”œâ”€â”€ v2/                   # è¡Œç¨‹ç”Ÿæˆ API (v2 LangGraph å¤šæ™ºèƒ½ä½“)
â”‚   â”‚   â”‚   â””â”€â”€ generate-itinerary/
â”‚   â”‚   â”œâ”€â”€ workflow-debug/       # å·¥ä½œæµè°ƒè¯• API
â”‚   â”‚   â”œâ”€â”€ metrics/              # Prometheus æŒ‡æ ‡ç«¯ç‚¹
â”‚   â”‚   â”œâ”€â”€ enrich-attraction/    # æ™¯ç‚¹ä¿¡æ¯å¢å¼º API
â”‚   â”‚   â”œâ”€â”€ enrich-hotel/         # é…’åº—ä¿¡æ¯å¢å¼º API
â”‚   â”‚   â”œâ”€â”€ expenses/             # è´¹ç”¨ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ weather/              # å¤©æ°”é¢„æŠ¥ API
â”‚   â”‚   â”œâ”€â”€ voice/                # è¯­éŸ³ç›¸å…³ API
â”‚   â”‚   â”œâ”€â”€ user/                 # ç”¨æˆ·ç›¸å…³ API
â”‚   â”‚   â”‚   â”œâ”€â”€ profile/          # ç”¨æˆ·é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ password/         # å¯†ç ä¿®æ”¹
â”‚   â”‚   â”‚   â””â”€â”€ api-keys/         # API Keys ç®¡ç†
â”‚   â”‚   â””â”€â”€ trips/                # è¡Œç¨‹ç›¸å…³ API
â”‚   â”‚       â”œâ”€â”€ [id]/share/       # åˆ†äº«é“¾æ¥ç®¡ç†
â”‚   â”‚       â””â”€â”€ share/[token]/    # è·å–å…¬å¼€è¡Œç¨‹
â”‚   â”œâ”€â”€ dashboard/                # ä»ªè¡¨æ¿é¡µé¢
â”‚   â”‚   â”œâ”€â”€ create/               # åˆ›å»ºè¡Œç¨‹
â”‚   â”‚   â”œâ”€â”€ settings/             # ç”¨æˆ·è®¾ç½®
â”‚   â”‚   â”œâ”€â”€ debug/                # å·¥ä½œæµè°ƒè¯•é¡µé¢ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
â”‚   â”‚   â””â”€â”€ trips/[id]/           # è¡Œç¨‹è¯¦æƒ…
â”‚   â”‚       â””â”€â”€ print/            # æ‰“å°ä¼˜åŒ–é¡µé¢
â”‚   â”œâ”€â”€ share/[token]/            # å…¬å¼€åˆ†äº«é¡µé¢
â”‚   â”œâ”€â”€ login/                    # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ register/                 # æ³¨å†Œé¡µé¢
â”‚   â”œâ”€â”€ providers.tsx             # å…¨å±€ Providerï¼ˆä¸»é¢˜ç­‰ï¼‰
â”‚   â””â”€â”€ page.tsx                  # é¦–é¡µ
â”œâ”€â”€ components/                   # React ç»„ä»¶
â”‚   â”œâ”€â”€ ui/                       # UI åŸºç¡€ç»„ä»¶ï¼ˆbutton, card, dialog ç­‰ï¼‰
â”‚   â”œâ”€â”€ shared/                   # å…±äº« UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PhotoCarousel.tsx     # ç…§ç‰‡è½®æ’­ç»„ä»¶
â”‚   â”‚   â””â”€â”€ RatingDisplay.tsx     # æ˜Ÿçº§è¯„åˆ†ç»„ä»¶
â”‚   â”œâ”€â”€ map/                      # åœ°å›¾ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ MapLegend.tsx         # åœ°å›¾å›¾ä¾‹
â”‚   â”‚   â””â”€â”€ TripMapToolbar.tsx    # åœ°å›¾å·¥å…·æ 
â”‚   â”œâ”€â”€ settings/                 # è®¾ç½®é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ProfileForm.tsx       # è´¦æˆ·ä¿¡æ¯è¡¨å•
â”‚   â”‚   â”œâ”€â”€ PasswordChangeForm.tsx # å¯†ç ä¿®æ”¹è¡¨å•
â”‚   â”‚   â”œâ”€â”€ PreferencesForm.tsx   # åå¥½è®¾ç½®è¡¨å•
â”‚   â”‚   â”œâ”€â”€ ApiKeyManager.tsx     # API Keys ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ AddApiKeyModal.tsx    # æ·»åŠ  Key æ¨¡æ€æ¡†
â”‚   â”‚   â””â”€â”€ api-keys/             # API Key å­ç»„ä»¶
â”‚   â”œâ”€â”€ VoiceInput.tsx            # è¯­éŸ³è¾“å…¥ç»„ä»¶
â”‚   â”œâ”€â”€ ModelSelector.tsx         # æ¨¡å‹é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ MapView.tsx               # é€šç”¨åœ°å›¾è§†å›¾
â”‚   â”œâ”€â”€ TripOverviewMap.tsx       # è¡Œç¨‹æ€»è§ˆåœ°å›¾
â”‚   â”œâ”€â”€ AttractionCard.tsx        # æ™¯ç‚¹å¡ç‰‡ç»„ä»¶
â”‚   â”œâ”€â”€ HotelCard.tsx             # é…’åº—å¡ç‰‡ç»„ä»¶
â”‚   â”œâ”€â”€ ShareButton.tsx           # åˆ†äº«æŒ‰é’®ç»„ä»¶
â”‚   â”œâ”€â”€ ExpenseForm.tsx           # è´¹ç”¨è¡¨å•
â”‚   â”œâ”€â”€ ExpenseList.tsx           # è´¹ç”¨åˆ—è¡¨
â”‚   â”œâ”€â”€ BudgetChart.tsx           # é¢„ç®—å›¾è¡¨
â”‚   â”œâ”€â”€ ExportPdfButton.tsx       # PDF å¯¼å‡ºæŒ‰é’®
â”‚   â”œâ”€â”€ ExportPdfDialog.tsx       # PDF å¯¼å‡ºå¯¹è¯æ¡†
â”‚   â”œâ”€â”€ OfflineIndicator.tsx      # ç¦»çº¿çŠ¶æ€æŒ‡ç¤ºå™¨
â”‚   â”œâ”€â”€ SyncStatus.tsx            # åŒæ­¥çŠ¶æ€ç»„ä»¶
â”‚   â”œâ”€â”€ InstallPrompt.tsx         # PWA å®‰è£…æç¤º
â”‚   â””â”€â”€ CacheManager.tsx          # ç¼“å­˜ç®¡ç†å™¨
â”œâ”€â”€ hooks/                        # React Hooksï¼ˆ12 ä¸ªï¼‰
â”‚   â”œâ”€â”€ useAuth.ts                # è®¤è¯ Hook
â”‚   â”œâ”€â”€ useAuthFetch.ts           # å¸¦è®¤è¯çš„è¯·æ±‚ Hook
â”‚   â”œâ”€â”€ useAMapLoader.ts          # é«˜å¾·åœ°å›¾åŠ è½½ Hook
â”‚   â”œâ”€â”€ useAmapInstance.ts        # é«˜å¾·åœ°å›¾å®ä¾‹ Hook
â”‚   â”œâ”€â”€ useMapMarkers.ts          # åœ°å›¾æ ‡è®°ç®¡ç† Hook
â”‚   â”œâ”€â”€ useMapRoutes.ts           # åœ°å›¾è·¯çº¿ç®¡ç† Hook
â”‚   â”œâ”€â”€ usePhotoCarousel.ts       # ç…§ç‰‡è½®æ’­é€»è¾‘ Hook
â”‚   â”œâ”€â”€ useApiKeyCheck.ts         # API Key æ£€æŸ¥ Hook
â”‚   â”œâ”€â”€ useLangGraphProgress.ts   # LangGraph è¿›åº¦ç›‘å¬ Hook
â”‚   â”œâ”€â”€ useOfflineTrip.ts         # å•ä¸ªç¦»çº¿è¡Œç¨‹ Hook
â”‚   â”œâ”€â”€ useOfflineTrips.ts        # å¤šä¸ªç¦»çº¿è¡Œç¨‹ Hook
â”‚   â”œâ”€â”€ useSync.ts                # æ•°æ®åŒæ­¥ Hook
â”‚   â””â”€â”€ useServerStatus.ts        # æœåŠ¡å™¨çŠ¶æ€æ£€æŸ¥ Hook
â”œâ”€â”€ lib/                          # å·¥å…·åº“
â”‚   â”œâ”€â”€ agents/                   # LangGraph å¤šæ™ºèƒ½ä½“æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ state.ts              # TripState Annotation å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ workflow.ts           # StateGraph å·¥ä½œæµå®šä¹‰
â”‚   â”‚   â”œâ”€â”€ mcp-client.ts         # MCP å®¢æˆ·ç«¯å°è£…
â”‚   â”‚   â”œâ”€â”€ checkpointer.ts       # æ£€æŸ¥ç‚¹å­˜å‚¨ï¼ˆå†…å­˜/PostgreSQLï¼‰
â”‚   â”‚   â”œâ”€â”€ tracer.ts             # å·¥ä½œæµè¿½è¸ªå™¨
â”‚   â”‚   â”œâ”€â”€ metrics.ts            # æ‰§è¡ŒæŒ‡æ ‡æ”¶é›†
â”‚   â”‚   â”œâ”€â”€ nodes/                # Agent èŠ‚ç‚¹å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ weather-scout.ts  # å¤©æ°”æ„ŸçŸ¥ Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ itinerary-planner.ts # æ ¸å¿ƒè§„åˆ’ Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ accommodation.ts  # ä½å®¿ä¸“å®¶ Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ transport.ts      # äº¤é€šè°ƒåº¦ Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ dining.ts         # é¤é¥®æ¨è Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ budget-critic.ts  # é¢„ç®—å®¡è®¡ Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ attraction-enricher.ts # æ™¯ç‚¹è¯¦æƒ… Agent
â”‚   â”‚   â”‚   â””â”€â”€ finalize.ts       # æ±‡æ€»è¾“å‡º Agent
â”‚   â”‚   â””â”€â”€ prompts/              # Agent System Prompts
â”‚   â”œâ”€â”€ database/                 # Supabase æ¨¡å—åŒ–ç›®å½•
â”‚   â”‚   â”œâ”€â”€ client.ts             # å®¢æˆ·ç«¯åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ auth.ts               # è®¤è¯æ“ä½œ
â”‚   â”‚   â””â”€â”€ schema.ts             # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ api-keys/                 # API Key ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ client.ts             # è·å–ã€è§£å¯†ã€ç¼“å­˜
â”‚   â”‚   â”œâ”€â”€ validator.ts          # API Key æµ‹è¯•
â”‚   â”‚   â””â”€â”€ checker.ts            # å¯ç”¨æ€§æ£€æŸ¥
â”‚   â”œâ”€â”€ pdf/                      # PDF å¯¼å‡ºæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ sections/             # PDF å„éƒ¨åˆ†ï¼ˆå°é¢ã€æ€»è§ˆã€æ¯æ—¥è®¡åˆ’ç­‰ï¼‰
â”‚   â”‚   â””â”€â”€ utils/                # PDF å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ services/                 # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ trip.service.ts       # è¡Œç¨‹æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ expense.service.ts    # è´¹ç”¨æœåŠ¡
â”‚   â”‚   â””â”€â”€ ai.service.ts         # AI è°ƒç”¨æœåŠ¡
â”‚   â”œâ”€â”€ repositories/             # æ•°æ®ä»“å‚¨å±‚
â”‚   â”‚   â”œâ”€â”€ trip.repository.ts    # è¡Œç¨‹ä»“å‚¨
â”‚   â”‚   â””â”€â”€ expense.repository.ts # è´¹ç”¨ä»“å‚¨
â”‚   â”œâ”€â”€ stores/                   # çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰
â”‚   â”œâ”€â”€ config/                   # é…ç½®æ¨¡å—
â”‚   â”œâ”€â”€ constants/                # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ errors/                   # è‡ªå®šä¹‰é”™è¯¯ç±»
â”‚   â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ fonts/                    # å­—ä½“æ–‡ä»¶
â”‚   â”œâ”€â”€ models.ts                 # AI æ¨¡å‹é…ç½®
â”‚   â”œâ”€â”€ encryption.ts             # AES-256 åŠ å¯†å·¥å…·
â”‚   â”œâ”€â”€ share.ts                  # åˆ†äº«åŠŸèƒ½å·¥å…·
â”‚   â”œâ”€â”€ offline.ts                # IndexedDB ç¦»çº¿æ•°æ®ç®¡ç†
â”‚   â”œâ”€â”€ sync.ts                   # æ•°æ®åŒæ­¥å¼•æ“
â”‚   â”œâ”€â”€ coordinate-converter.ts   # WGS84 <-> GCJ-02 åæ ‡è½¬æ¢
â”‚   â”œâ”€â”€ geo-clustering.ts         # åœ°ç†ä½ç½®èšç±»ä¼˜åŒ–
â”‚   â”œâ”€â”€ map-markers.ts            # åœ°å›¾æ ‡è®°å·¥å…·
â”‚   â”œâ”€â”€ ui-helpers.ts             # UI è¾…åŠ©å‡½æ•°
â”‚   â””â”€â”€ analytics.ts              # åˆ†æå·¥å…·
â”œâ”€â”€ types/                        # TypeScript ç±»å‹
â”‚   â”œâ”€â”€ index.ts                  # æ ¸å¿ƒç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ supabase.d.ts             # Supabase è¡¨ç±»å‹
â”‚   â”œâ”€â”€ amap.d.ts                 # é«˜å¾·åœ°å›¾ç±»å‹å£°æ˜
â”‚   â””â”€â”€ expense.ts                # è´¹ç”¨ç›¸å…³ç±»å‹
â”œâ”€â”€ __tests__/                    # å•å…ƒå’Œé›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ setup.ts                  # Vitest å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ lib/                      # åº“å‡½æ•°æµ‹è¯•
â”‚   â”œâ”€â”€ api/                      # API è·¯ç”±æµ‹è¯•
â”‚   â”œâ”€â”€ integration/              # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ mocks/                    # æµ‹è¯• Mock
â”‚   â””â”€â”€ utils/                    # æµ‹è¯•è¾…åŠ©å‡½æ•°
â”œâ”€â”€ e2e/                          # Playwright E2E æµ‹è¯•
â”‚   â”œâ”€â”€ helpers.ts                # E2E è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ create-trip.spec.ts       # åˆ›å»ºè¡Œç¨‹æµ‹è¯•
â”‚   â”œâ”€â”€ export-pdf.spec.ts        # PDF å¯¼å‡ºæµ‹è¯•
â”‚   â””â”€â”€ share-trip.spec.ts        # åˆ†äº«è¡Œç¨‹æµ‹è¯•
â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£ï¼ˆ40+ï¼‰
â”‚   â”œâ”€â”€ README.md                 # æ–‡æ¡£ç´¢å¼•
â”‚   â”œâ”€â”€ QUICK_START.md            # å¿«é€Ÿå¯åŠ¨æŒ‡å—
â”‚   â”œâ”€â”€ TESTING_GUIDE.md          # æµ‹è¯•æŒ‡å—
â”‚   â”œâ”€â”€ E2E_TESTING.md            # E2E æµ‹è¯•æŒ‡å—
â”‚   â””â”€â”€ ...                       # å…¶ä»–æŠ€æœ¯æ–‡æ¡£
â”œâ”€â”€ scripts/                      # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ health-check.js           # å¥åº·æ£€æŸ¥è„šæœ¬
â”‚   â”œâ”€â”€ dev-safe.sh               # å®‰å…¨å¯åŠ¨ï¼ˆLinux/Macï¼‰
â”‚   â””â”€â”€ dev-safe.bat              # å®‰å…¨å¯åŠ¨ï¼ˆWindowsï¼‰
â”œâ”€â”€ database/                     # æ•°æ®åº“è„šæœ¬
â”‚   â”œâ”€â”€ init.sql                  # ç»Ÿä¸€æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ (v3.1)
â”‚   â””â”€â”€ migrations/               # æ•°æ®åº“è¿ç§»è„šæœ¬
â”œâ”€â”€ public/                       # é™æ€èµ„æº
â”‚   â”œâ”€â”€ manifest.json             # PWA manifest æ–‡ä»¶
â”‚   â””â”€â”€ icons/                    # PWA åº”ç”¨å›¾æ ‡
â”œâ”€â”€ vitest.config.ts              # Vitest å•å…ƒæµ‹è¯•é…ç½®
â”œâ”€â”€ playwright.config.ts          # Playwright E2E æµ‹è¯•é…ç½®
â”œâ”€â”€ ecosystem.config.js           # PM2 é…ç½®æ–‡ä»¶
â”œâ”€â”€ .env.example                  # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ mcp-servers/                  # MCP Server ç‹¬ç«‹é¡¹ç›®
â”‚   â””â”€â”€ amap/                     # é«˜å¾·åœ°å›¾ MCP Server
â”‚       â”œâ”€â”€ src/                  # æºä»£ç 
â”‚       â”‚   â”œâ”€â”€ tools/            # MCP å·¥å…·ï¼ˆå¤©æ°”ã€POIã€è·¯çº¿ç­‰ï¼‰
â”‚       â”‚   â””â”€â”€ server.ts         # MCP Server ä¸»ç±»
â”‚       â””â”€â”€ tests/                # å•å…ƒæµ‹è¯•
```

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### profiles è¡¨
ç”¨æˆ·é…ç½®ä¿¡æ¯ï¼ˆæ‰©å±• Supabase auth.usersï¼‰
- åŸºæœ¬ä¿¡æ¯ï¼šemailã€nameã€avatar_url
- ä¸»é¢˜è®¾ç½®ï¼štheme (light/dark/system)
- é»˜è®¤åå¥½ï¼šdefault_modelã€default_budgetã€default_origin

### trips è¡¨
- åŸºæœ¬ä¿¡æ¯ï¼šoriginï¼ˆå‡ºå‘åœ°ï¼‰ã€destinationï¼ˆç›®çš„åœ°ï¼‰ã€æ—¥æœŸã€é¢„ç®—ã€äººæ•°
- è¡Œç¨‹æ•°æ®ï¼šitinerary (JSONB)
- çŠ¶æ€ï¼šdraft/planned/ongoing/completed
- åˆ†äº«ï¼šshare_tokenï¼ˆåˆ†äº«æ ‡è¯†ï¼‰ã€is_publicï¼ˆæ˜¯å¦å…¬å¼€ï¼‰

### expenses è¡¨
- åˆ†ç±»ï¼šaccommodation/transportation/food/attractions/shopping/other
- å…³è”ï¼štrip_id
- å­—æ®µï¼šamountï¼ˆé‡‘é¢ï¼‰ã€descriptionï¼ˆæè¿°ï¼‰ã€dateï¼ˆæ—¥æœŸï¼‰

### api_keys è¡¨
- ç”¨æˆ·è‡ªå®šä¹‰ API Keysï¼ˆAES-256 åŠ å¯†å­˜å‚¨ï¼‰
- æœåŠ¡ç±»å‹ï¼šanthropic / deepseek / modelscope / map / voice
- å­—æ®µï¼šencrypted_keyï¼ˆåŠ å¯†å¯†é’¥ï¼‰ã€key_prefixï¼ˆæ˜¾ç¤ºå‰ç¼€ï¼‰ã€is_activeï¼ˆæ˜¯å¦æ¿€æ´»ï¼‰

è¯¦ç»†çš„æ•°æ®åº“è®¾ç½®è¯·æŸ¥çœ‹ [docs/DATABASE_SETUP.md](docs/DATABASE_SETUP.md)

## ğŸš€ éƒ¨ç½²

### Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. å°†ä»£ç æ¨é€åˆ° GitHub
2. åœ¨ [Vercel](https://vercel.com) å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²å®Œæˆ

è¯¦ç»†æ­¥éª¤è¯·æŸ¥çœ‹ [DEPLOYMENT.md](DEPLOYMENT.md)

## ğŸ“± PWA å’Œç¦»çº¿åŠŸèƒ½

### å®‰è£… PWA

åº”ç”¨æ”¯æŒå®‰è£…åˆ°è®¾å¤‡ä¸»å±å¹•ï¼ŒåƒåŸç”Ÿåº”ç”¨ä¸€æ ·ä½¿ç”¨ã€‚

**æ‰‹æœºç«¯ï¼ˆAndroid/iOSï¼‰**ï¼š
1. ä½¿ç”¨ Chrome/Safari è®¿é—®åº”ç”¨
2. ç‚¹å‡»é¡µé¢é¡¶éƒ¨çš„"å®‰è£… AI æ—…è¡Œè§„åˆ’"æ¨ªå¹…
3. æˆ–é€šè¿‡æµè§ˆå™¨èœå•é€‰æ‹©"æ·»åŠ åˆ°ä¸»å±å¹•"

**æ¡Œé¢ç«¯ï¼ˆChrome/Edgeï¼‰**ï¼š
1. è®¿é—®åº”ç”¨
2. ç‚¹å‡»åœ°å€æ çš„å®‰è£…å›¾æ ‡
3. ç¡®è®¤å®‰è£…

### ä½¿ç”¨ç¦»çº¿åŠŸèƒ½

**å‡†å¤‡ç¦»çº¿ä½¿ç”¨**ï¼ˆéœ€è¦ç½‘ç»œï¼‰ï¼š
1. ç™»å½•è´¦å·
2. è®¿é—®æ‚¨æƒ³ç¦»çº¿æŸ¥çœ‹çš„è¡Œç¨‹
3. ç­‰å¾…å³ä¸‹è§’æ˜¾ç¤º"å·²åŒæ­¥"

**ç¦»çº¿è®¿é—®**ï¼ˆæ— éœ€ç½‘ç»œï¼‰ï¼š
- âœ… æŸ¥çœ‹å·²ç¼“å­˜çš„è¡Œç¨‹è¯¦æƒ…
- âœ… ç¼–è¾‘è¡Œç¨‹ä¿¡æ¯
- âœ… æŸ¥çœ‹è´¹ç”¨è®°å½•
- âœ… æŸ¥çœ‹åœ°å›¾ï¼ˆéœ€äº‹å…ˆåŠ è½½ï¼‰

**æ•°æ®åŒæ­¥**ï¼š
- ç½‘ç»œæ¢å¤åè‡ªåŠ¨åŒæ­¥ç¦»çº¿ç¼–è¾‘
- å³ä¸‹è§’æ˜¾ç¤ºåŒæ­¥çŠ¶æ€å’Œè¿›åº¦
- æ”¯æŒæ‰‹åŠ¨è§¦å‘åŒæ­¥

### ç¼“å­˜ç®¡ç†

åœ¨ Dashboard ç‚¹å‡»"ç¼“å­˜"æŒ‰é’®å¯ä»¥ï¼š
- æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
- æ¸…é™¤æœ¬åœ°ç¼“å­˜
- åˆ·æ–°æ•°æ®

### è¯¦ç»†æ–‡æ¡£

- **æŠ€æœ¯å®ç°**: [docs/PWA_IMPLEMENTATION.md](docs/PWA_IMPLEMENTATION.md)
- **ç”¨æˆ·æŒ‡å—**: [docs/OFFLINE_USAGE.md](docs/OFFLINE_USAGE.md)

## â“ å¸¸è§é—®é¢˜

### è¯­éŸ³è¾“å…¥ä¸å¯ç”¨ï¼Ÿ
- ç¡®ä¿ä½¿ç”¨ HTTPS æˆ– localhost
- ä½¿ç”¨æ”¯æŒçš„æµè§ˆå™¨ï¼ˆChrome/Edge/Safariï¼‰
- æˆæƒéº¦å…‹é£æƒé™

### AI ç”Ÿæˆå¤±è´¥ï¼Ÿ
- æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ API é…é¢å……è¶³
- æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯

### æ•°æ®åº“ä¿å­˜å¤±è´¥ï¼Ÿ
- ç¡®ä¿è¿è¡Œäº† `database/init.sql` åˆå§‹åŒ–è„šæœ¬
- æ£€æŸ¥ RLS ç­–ç•¥æ˜¯å¦å¯ç”¨
- ç¡®è®¤ç”¨æˆ·å·²ç™»å½•

### åœ°å›¾æ— æ³•æ˜¾ç¤ºï¼Ÿ
- æ£€æŸ¥æ˜¯å¦é…ç½®äº† `NEXT_PUBLIC_MAP_API_KEY`
- ç¡®è®¤ API Key æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹ [docs/MAP_INTEGRATION.md](docs/MAP_INTEGRATION.md) è·å–è¯¦ç»†é…ç½®è¯´æ˜

### ç«¯å£è¢«å ç”¨æˆ–åƒµå°¸è¿›ç¨‹ï¼Ÿ
- ä½¿ç”¨ `npm run dev:check` æ£€æŸ¥å¥åº·çŠ¶æ€
- ä½¿ç”¨ `npm run cleanup` è‡ªåŠ¨æ¸…ç†åƒµå°¸è¿›ç¨‹
- æ¨èä½¿ç”¨ `npm run dev:safe` å¯åŠ¨ï¼Œè‡ªåŠ¨å¤„ç†ç«¯å£é—®é¢˜
- æŸ¥çœ‹ [docs/PROCESS_MANAGEMENT.md](docs/PROCESS_MANAGEMENT.md) è·å–è¯¦ç»†è¯´æ˜

## ğŸ“ æ›´æ–°æ—¥å¿—

æŸ¥çœ‹ [CHANGELOG.md](docs/CHANGELOG.md) äº†è§£ç‰ˆæœ¬æ›´æ–°å†å²ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æ³¨æ„**: æœ¬é¡¹ç›®å¤„äºæ´»è·ƒå¼€å‘ä¸­ã€‚ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰è¯·ç¡®ä¿å®Œæˆå®‰å…¨å®¡è®¡å’Œæ€§èƒ½æµ‹è¯•ã€‚
